<!DOCTYPE html><html lang="zh-TW" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="ç•¶ Decodable é‡ä¸Š @propertyWrapper" /><meta property="og:locale" content="zh_TW" /><meta name="description" content="åœ¨ Swift 5.1 ä¹‹å¾Œï¼Œè˜‹æœçˆ¸çˆ¸æ¨å‡ºäº† @propertyWrapper ( SE-0258 )ï¼Œå±¬æ€§åŒ…è£å™¨ï¼Œè©³ç´°çš„ä½¿ç”¨åŠèªªæ˜ï¼Œé€™é‚Šå°±ä¸å¤šåšä»‹ç´¹äº†ã€‚å‰›é–‹å§‹çš„æ™‚å€™æœ€å¸¸çœ‹åˆ°çš„æ‡‰ç”¨æ˜¯ Userdefaultsï¼Œæˆ‘è‡ªå·±åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨çš„éƒ¨åˆ†å‰‡æ˜¯ Begin/End of dateï¼Œå› ç‚ºæœ‰é¸æ“‡æ—¥æœŸå€é–“çš„éœ€æ±‚ï¼Œæ‰€ä»¥åšäº†ä¸€å€‹é€™æ¨£çš„å±¬æ€§ï¼Œåœ¨ init çš„æ™‚å€™æŒ‡å®šå¥½æ˜¯ Begin or Endï¼Œget çš„æ™‚å€™å°±æœƒå…ˆæ•´ç†ä¸€æ¬¡æ—¥æœŸï¼Œè©³ç´°çš„å¯¦ä½œæˆ‘æ”¾åœ¨ Gist æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚" /><meta property="og:description" content="åœ¨ Swift 5.1 ä¹‹å¾Œï¼Œè˜‹æœçˆ¸çˆ¸æ¨å‡ºäº† @propertyWrapper ( SE-0258 )ï¼Œå±¬æ€§åŒ…è£å™¨ï¼Œè©³ç´°çš„ä½¿ç”¨åŠèªªæ˜ï¼Œé€™é‚Šå°±ä¸å¤šåšä»‹ç´¹äº†ã€‚å‰›é–‹å§‹çš„æ™‚å€™æœ€å¸¸çœ‹åˆ°çš„æ‡‰ç”¨æ˜¯ Userdefaultsï¼Œæˆ‘è‡ªå·±åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨çš„éƒ¨åˆ†å‰‡æ˜¯ Begin/End of dateï¼Œå› ç‚ºæœ‰é¸æ“‡æ—¥æœŸå€é–“çš„éœ€æ±‚ï¼Œæ‰€ä»¥åšäº†ä¸€å€‹é€™æ¨£çš„å±¬æ€§ï¼Œåœ¨ init çš„æ™‚å€™æŒ‡å®šå¥½æ˜¯ Begin or Endï¼Œget çš„æ™‚å€™å°±æœƒå…ˆæ•´ç†ä¸€æ¬¡æ—¥æœŸï¼Œè©³ç´°çš„å¯¦ä½œæˆ‘æ”¾åœ¨ Gist æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚" /><link rel="canonical" href="https://ohlulu.github.io/posts/decodable_propertywrapper/" /><meta property="og:url" content="https://ohlulu.github.io/posts/decodable_propertywrapper/" /><meta property="og:site_name" content="Ohlulu" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-18T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ç•¶ Decodable é‡ä¸Š @propertyWrapper" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-07-18T00:00:00+08:00","datePublished":"2020-07-18T00:00:00+08:00","description":"åœ¨ Swift 5.1 ä¹‹å¾Œï¼Œè˜‹æœçˆ¸çˆ¸æ¨å‡ºäº† @propertyWrapper ( SE-0258 )ï¼Œå±¬æ€§åŒ…è£å™¨ï¼Œè©³ç´°çš„ä½¿ç”¨åŠèªªæ˜ï¼Œé€™é‚Šå°±ä¸å¤šåšä»‹ç´¹äº†ã€‚å‰›é–‹å§‹çš„æ™‚å€™æœ€å¸¸çœ‹åˆ°çš„æ‡‰ç”¨æ˜¯ Userdefaultsï¼Œæˆ‘è‡ªå·±åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨çš„éƒ¨åˆ†å‰‡æ˜¯ Begin/End of dateï¼Œå› ç‚ºæœ‰é¸æ“‡æ—¥æœŸå€é–“çš„éœ€æ±‚ï¼Œæ‰€ä»¥åšäº†ä¸€å€‹é€™æ¨£çš„å±¬æ€§ï¼Œåœ¨ init çš„æ™‚å€™æŒ‡å®šå¥½æ˜¯ Begin or Endï¼Œget çš„æ™‚å€™å°±æœƒå…ˆæ•´ç†ä¸€æ¬¡æ—¥æœŸï¼Œè©³ç´°çš„å¯¦ä½œæˆ‘æ”¾åœ¨ Gist æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚","headline":"ç•¶ Decodable é‡ä¸Š @propertyWrapper","mainEntityOfPage":{"@type":"WebPage","@id":"https://ohlulu.github.io/posts/decodable_propertywrapper/"},"url":"https://ohlulu.github.io/posts/decodable_propertywrapper/"}</script><title>ç•¶ Decodable é‡ä¸Š @propertyWrapper | Ohlulu</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ohlulu"><meta name="application-name" content="Ohlulu"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ohlulu</a></div><div class="site-subtitle font-italic">iOS Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>é¦–é </span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>åˆ†é¡</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>æ¨™ç°½</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>æ­¸æª”</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ohlulu" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> é¦–é  </a> </span> <span>ç•¶ Decodable é‡ä¸Š @propertyWrapper</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> æ–‡ç« </div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="æœç´¢..."> </span> <span id="search-cancel" >å–æ¶ˆ</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ç•¶ Decodable é‡ä¸Š @propertyWrapper</h1><div class="post-meta text-muted"><div> ä½œè€… <em> <a href="https://twitter.com/username">ohlulu</a> </em></div><div class="d-flex"><div> <span> ç™¼è¡¨æ–¼ <em class="timeago" data-ts="1595001600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-07-18 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2017 å­—"> <em>11 åˆ†é˜</em>é–±è®€</span></div></div></div><div class="post-content"><p>åœ¨ Swift 5.1 ä¹‹å¾Œï¼Œè˜‹æœçˆ¸çˆ¸æ¨å‡ºäº† @propertyWrapper ( <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0258-property-wrappers.md">SE-0258</a> )ï¼Œå±¬æ€§åŒ…è£å™¨ï¼Œè©³ç´°çš„ä½¿ç”¨åŠèªªæ˜ï¼Œé€™é‚Šå°±ä¸å¤šåšä»‹ç´¹äº†ã€‚å‰›é–‹å§‹çš„æ™‚å€™æœ€å¸¸çœ‹åˆ°çš„æ‡‰ç”¨æ˜¯ Userdefaultsï¼Œæˆ‘è‡ªå·±åœ¨å°ˆæ¡ˆä¸­æ‡‰ç”¨çš„éƒ¨åˆ†å‰‡æ˜¯ Begin/End of dateï¼Œå› ç‚ºæœ‰é¸æ“‡æ—¥æœŸå€é–“çš„éœ€æ±‚ï¼Œæ‰€ä»¥åšäº†ä¸€å€‹é€™æ¨£çš„å±¬æ€§ï¼Œåœ¨ init çš„æ™‚å€™æŒ‡å®šå¥½æ˜¯ Begin or Endï¼Œget çš„æ™‚å€™å°±æœƒå…ˆæ•´ç†ä¸€æ¬¡æ—¥æœŸï¼Œè©³ç´°çš„å¯¦ä½œæˆ‘æ”¾åœ¨ <a href="https://gist.github.com/ohlulu/33cb78e298744d6fc4c8fae23e6fdd65">Gist</a> æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚</p><h2 id="-æƒ…å¢ƒ"><span class="mr-2"># æƒ…å¢ƒ</span><a href="#-æƒ…å¢ƒ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>ç•¶æˆ‘å¾…åœ¨ Agency çš„æ™‚å€™ç¶“å¸¸é‡åˆ°ä¸€å€‹å•é¡Œï¼Œå¾Œç«¯çš„ API æ²’æœ‰ç…§ Spec åšï¼Œå°¤å…¶æ˜¯å‹åˆ¥çš„å•é¡Œï¼Œæˆ‘æƒ³é€™æ‡‰è©²å¾ˆå¤šäººéƒ½æœ‰é‡éï¼ŒSpec æ˜æ˜å®šç¾©çš„æ˜¯ Intï¼Œå¾Œç«¯å‚³å»æ˜¯ Stringã€‚æˆ–æ˜¯å› ç‚ºæŸäº›ä¸æ˜çš„åŸå› ï¼Œå¾Œç«¯æ¼å‚³äº†æŸå€‹æ¬„ä½ï¼Œä½†å¯¦éš›ä¸Šé€™å€‹æ¬„ä½æ˜¯å¿…é ˆå­˜åœ¨çš„ã€‚ç”šè‡³æ˜¯å¾Œç«¯ key æ‰“éŒ¯äº†ã€‚æ›´æ·’æ…˜çš„æ˜¯ï¼Œå¦‚æœæ˜¯ Array ä¸­æŸå€‹å€¼éŒ¯äº†ï¼Œæ•´å¤§åŒ…å°±æœƒè§£æå¤±æ•—ã€‚</p><p>åœ¨ä»¥å‰ï¼Œæˆ‘å€‘æœ‰å¹¾å€‹æ–¹å¼å¯ä»¥è§£æ±ºé€™äº›å•å•é¡Œï¼š</p><ol><li>è‡ªå·±å®šç¾©ä¸€å€‹å‹åˆ¥ï¼š å¯èƒ½åƒæ˜¯ StringOrInt é€™ç¨®ï¼Œä¸¦å¯¦ä½œ Decodableã€‚ä½†é€™åªèƒ½è§£æ±º String â†” Intï¼Œé€™ç¨®éŒ¯èª¤ã€‚<li>Decode å¤±æ•—å°±å¤±æ•—ï¼šä½†æ¯æ¬¡å¤±æ•—æˆ‘éƒ½æœƒå°‡ DecodingError ç›´æ¥ç”¨ Alert show åœ¨ç•«é¢ä¸Šï¼Œæ‰€ä»¥åªè¦æœ‰äººæ¸¬åˆ° DecoginError ç›¸é—œçš„å•é¡Œï¼Œå°±å¯ä»¥ç›´æ¥è¢å¹•æˆªåœ–ä¸¦å‚³çµ¦æˆ‘ï¼Œæˆ‘å¯ä»¥æ¯”è¼ƒç¶“é¬†çš„å®šä½å¤±æ•—çš„ APIï¼Œä¸¦é€šçŸ¥å¾Œç«¯ä¿®æ­£ã€‚ï¼ˆç•¶ç„¶é€™ç¨®ä½œæ³•å¿…é ˆé™å®šåœ¨é–‹ç™¼ç’°å¢ƒï¼‰<li>æŠŠæ‰€æœ‰çš„è®Šæ•¸éƒ½å®£å‘Šæˆ Optionalï¼šä½†é€™åªèƒ½è§£æ±º KeyNotFoundï¼Œè€Œä¸”å¾ŒçºŒçš„é–‹ç™¼ä¸Šéœ€è¦è™•ç†ä¸€å † Optionalã€‚<li>è‡ªå·±å¯¦ä½œ init(from decoder: Decoder) ï¼šä½†æˆ‘ä¸å¯èƒ½ã€ä¹Ÿä¸æƒ³ç‚ºæ¯å€‹ response model å¯¦åšé€™å€‹ funcï¼Œè²»æ™‚åˆè²»åŠ›ï¼Œå¾ˆä¸å·¥ç¨‹å¸«ã€‚</ol><h2 id="-é‚„æ˜¯æœ‰ä¸€äº›å•é¡Œ"><span class="mr-2"># é‚„æ˜¯æœ‰ä¸€äº›å•é¡Œ</span><a href="#-é‚„æ˜¯æœ‰ä¸€äº›å•é¡Œ" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>ä¸Šé¢çš„è§£æ³•åœ¨æŸç¨®ç¨‹åº¦ä¸Šåˆ†åˆ¥è§£æ±ºäº† DecodingError çš„å•é¡Œï¼Œä½†ä¾ç„¶æœ‰ä¸€äº›å•é¡Œï¼š</p><ol><li>è§£æ±ºæ–¹æ³•æ²’æœ‰çµ±ä¸€çš„ä»‹é¢ã€‚ï¼ˆé†œï¼‰<li>æŸäº›æ–¹æ³•å¯¦ä½œä¸æ˜“ã€‚ï¼ˆéº»ç…©ï¼‰<li>æŸäº›æ–¹æ³•å‡ºéŒ¯çš„æ™‚å€™å®šä½ä¸å®¹æ˜“ï¼Œå› ç‚ºæœ¬è³ªä¸Šæ˜¯ Bug ï¼Œæ˜¯éœ€è¦è¢«è§£æ±ºçš„ã€‚<li>å¾Œç«¯çš„é‹ç‚ºæ¯›æ˜¯æˆ‘å€‘æ‰›ï¼Ÿç‚ºæ¯›æ˜¯æˆ‘å€‘è¦æ‰¾å‡ºå•é¡Œåœ¨å“ªï¼Œå†è«‹å¾Œç«¯æ”¹ï¼Ÿï¼ˆğŸ˜  ï¼‰</ol><h2 id="-decodestrategy"><span class="mr-2"># DecodeStrategy</span><a href="#-decodestrategy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Of course, DecodeStrategy èª•ç”Ÿäº†ã€‚</p><p>æœ€åˆçš„æƒ³æ³•æ˜¯æƒ³ç”¨ã€Œä¸€å€‹ @propertyWrapperã€ä¾†è§£æ±ºæ‰€æœ‰å•é¡Œï¼Œä½†å˜—è©¦åˆ°ä¸€åŠç™¼ç¾çœŸçš„åšä¸åˆ° ( æˆ–è¨±æ˜¯æˆ‘å¤ªèœäº†QQ )ï¼ŒåŠ ä¸Š<a href="https://www.ohlulu.tw/2019/08/13/ohswifterframework/">ä¹‹å‰</a>å­¸åˆ°çš„æ•™è¨“ ã€Œä¸è¦è©¦åœ–åœ¨ä¸€è¡Œ code è£¡é¢åŒ…å±±åŒ…æµ·ã€ã€‚æˆ‘æ±ºå®šé‡å°å„å€‹ç‹€æ³å„è‡ªä½¿ç”¨ä¸€å€‹ @propertyWrapperã€‚</p><p>è®“æˆ‘å€‘ä¸€å€‹ä¸€å€‹ä¾†çœ‹ï¼š</p><ol><li><h4 id="é¦–å…ˆæ˜¯é è¨­å€¼çš„éƒ¨åˆ†åœ¨æŸäº›æƒ…æ³ä¹‹ä¸‹æˆ‘å¸Œæœ›è§£æå¤±æ•—çš„æ™‚å€™model-å¯ä»¥æœ‰é è¨­å€¼"><span class="mr-2">é¦–å…ˆæ˜¯é è¨­å€¼çš„éƒ¨åˆ†ï¼šåœ¨æŸäº›æƒ…æ³ä¹‹ä¸‹ï¼Œæˆ‘å¸Œæœ›è§£æå¤±æ•—çš„æ™‚å€™ï¼ŒModel å¯ä»¥æœ‰é è¨­å€¼ã€‚</span><a href="#é¦–å…ˆæ˜¯é è¨­å€¼çš„éƒ¨åˆ†åœ¨æŸäº›æƒ…æ³ä¹‹ä¸‹æˆ‘å¸Œæœ›è§£æå¤±æ•—çš„æ™‚å€™model-å¯ä»¥æœ‰é è¨­å€¼" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>æœ€æ—©çš„æƒ³æ³•æ˜¯ï¼Œåœ¨ propertyWrapper init çš„æ™‚å€™ï¼Œé †ä¾¿æŒ‡å®šé è¨­å€¼æ˜¯ä»€éº¼ã€‚ <code class="language-plaintext highlighter-rouge">@DecodeHasDefault("Something error")</code> ä½†é€™æ¨£çš„åšæ³•æœƒè·Ÿ <code class="language-plaintext highlighter-rouge">init(from decoder: Decoder)</code> è¡çªï¼Œæ‰€ä»¥å¾Œä¾†æ”¹ç”¨ Provider çš„æ–¹å¼ä¾†æä¾›é è¨­å€¼ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">DecodeDefaultProvider</span> <span class="p">{</span>
     <span class="kd">associatedtype</span> <span class="kt">Value</span><span class="p">:</span> <span class="kt">Decodable</span>
     <span class="kd">static</span> <span class="k">var</span> <span class="nv">defaultValue</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
 <span class="p">}</span>
    
 <span class="kd">@propertyWrapper</span>
 <span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DecodeHasDefault</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
     <span class="kd">public</span> <span class="k">var</span> <span class="nv">wrappedValue</span><span class="p">:</span> <span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span>
    
     <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="nv">wrappedValue</span><span class="p">:</span> <span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">self</span><span class="o">.</span><span class="n">wrappedValue</span> <span class="o">=</span> <span class="n">wrappedValue</span>
     <span class="p">}</span>
    
     <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    
         <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">singleValueContainer</span><span class="p">()</span>
    
         <span class="k">do</span> <span class="p">{</span>
             <span class="n">wrappedValue</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
             <span class="n">wrappedValue</span> <span class="o">=</span> <span class="kt">Provider</span><span class="o">.</span><span class="n">defaultValue</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></table></code></div></div><p>ä½¿ç”¨èµ·ä¾†æœƒåƒæ˜¯é€™æ¨£</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> <span class="kd">struct</span> <span class="kt">User</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
     <span class="kd">struct</span> <span class="kt">NameDefault</span><span class="p">:</span> <span class="kt">DecodeDefaultProvider</span> <span class="p">{</span>
         <span class="kd">static</span> <span class="k">var</span> <span class="nv">defaultValue</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"ohlulu"</span>
     <span class="p">}</span>
    
     <span class="kd">@DecodeHasDefault</span>
     <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    
     <span class="kd">struct</span> <span class="kt">AgeDefault</span><span class="p">:</span> <span class="kt">DecodeDefaultProvider</span> <span class="p">{</span>
         <span class="kd">static</span> <span class="k">var</span> <span class="nv">defaultValue</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">18</span>
     <span class="p">}</span>
    
     <span class="kd">@DecodeHasDefault</span>
     <span class="k">var</span> <span class="nv">age</span><span class="p">:</span> <span class="kt">Int</span>
 <span class="p">}</span>
</pre></table></code></div></div><p>é€™éƒ¨åˆ†æ¯”è¼ƒå–®ç´”ï¼Œå°±æ˜¯æä¾›ä¸€å€‹ <code class="language-plaintext highlighter-rouge">DecodeDefaultProvider</code>ï¼Œè®“ <code class="language-plaintext highlighter-rouge">DecodeHasDefault</code> åœ¨ catch error çš„æ™‚å€™ä½¿ç”¨ defaultValue</p><li><h4 id="å†ä¾†æ˜¯-decodearray-çš„éƒ¨åˆ†"><span class="mr-2">å†ä¾†æ˜¯ DecodeArray çš„éƒ¨åˆ†ã€‚</span><a href="#å†ä¾†æ˜¯-decodearray-çš„éƒ¨åˆ†" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>é€™é‚Šæœ‰å…©ç¨®æƒ…æ³ï¼šä¸€ç¨®æ˜¯è§£æå¤±æ•—çš„æ™‚å€™ï¼Œç›´æ¥å¿½ç•¥è©² Elementã€‚å¦ä¸€ç¨®æ˜¯ä½¿ç”¨é è¨­çš„ Elementã€‚</p><ol><li>ç¬¬ä¸€ç¨®ï¼šDecodeArrayIgnore</ol><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre> <span class="kd">@propertyWrapper</span>
 <span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DecodeArrayIgnore</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
     <span class="kd">public</span> <span class="k">var</span> <span class="nv">wrappedValue</span><span class="p">:</span> <span class="p">[</span><span class="kt">Value</span><span class="p">]</span>
    
     <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    
         <span class="k">var</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">unkeyedContainer</span><span class="p">()</span>
         <span class="k">var</span> <span class="nv">result</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Value</span><span class="p">]()</span>
    
         <span class="k">while</span> <span class="o">!</span><span class="n">container</span><span class="o">.</span><span class="n">isAtEnd</span> <span class="p">{</span>
             <span class="k">do</span> <span class="p">{</span>
                 <span class="k">let</span> <span class="nv">element</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Value</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
                 <span class="n">result</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
             <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
                 <span class="n">_</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">AnyDecodable</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
             <span class="p">}</span>
         <span class="p">}</span>
         <span class="n">wrappedValue</span> <span class="o">=</span> <span class="n">result</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></table></code></div></div><p>é€™é‚Šéœ€è¦æ³¨æ„ï¼Œcatch error çš„æ™‚å€™é‚„æ˜¯è¦ decode æˆåŠŸä¸€æ¬¡ï¼Œä¸ç„¶ element ä¸æœƒå¾ container ä¸­ç§»é™¤ï¼Œæœƒé™·å…¥ä¸€å€‹ç„¡çª®è¿´åœˆï¼Œæ‰€ä»¥ç”¨ä¸€å€‹ç©ºçš„ <code class="language-plaintext highlighter-rouge">struct AnyDecodable</code> ä¾†åšé€™ä»¶äº‹ï¼Œå¦‚æœé‚„æ˜¯å¤±æ•—äº†ï¼Œå°± throw å‡ºå»å§ã€‚</p><ol><li>ç¬¬äºŒç¨®ï¼šDecodeArrayHasDefault</ol><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> <span class="kd">@propertyWrapper</span>
 <span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DecodeArrayHasDefault</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
     <span class="kd">public</span> <span class="k">var</span> <span class="nv">wrappedValue</span><span class="p">:</span> <span class="p">[</span><span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="p">]</span>
    
     <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    
         <span class="k">var</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">unkeyedContainer</span><span class="p">()</span>
         <span class="k">var</span> <span class="nv">result</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="p">]()</span>
    
         <span class="k">while</span> <span class="o">!</span><span class="n">container</span><span class="o">.</span><span class="n">isAtEnd</span> <span class="p">{</span>
             <span class="k">do</span> <span class="p">{</span>
                 <span class="k">let</span> <span class="nv">element</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
                 <span class="n">result</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
             <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
                 <span class="n">_</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">AnyDecodable</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
                 <span class="n">result</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">Provider</span><span class="o">.</span><span class="n">defaultValue</span><span class="p">)</span>
             <span class="p">}</span>
         <span class="p">}</span>
    
         <span class="n">wrappedValue</span> <span class="o">=</span> <span class="n">result</span>
     <span class="p">}</span>
 <span class="p">}</span>
    
</pre></table></code></div></div><p>è·Ÿä¸Šé¢å¾ˆåƒï¼Œåªæ˜¯ Generic çš„éƒ¨åˆ†æ”¹æˆäº† <code class="language-plaintext highlighter-rouge">DecodeDefaultProvider</code>ï¼Œé€™é‚Šæœƒé¸æ“‡æ‹†æˆç†å€‹ <code class="language-plaintext highlighter-rouge">@propertyWrapper</code> æ˜¯å› ç‚º ignore ä¸éœ€è¦ Provider ï¼Œç•¶ç„¶ Provider ä¹Ÿå¯ä»¥æä¾›ä¸€å€‹é¡ä¼¼ Optional çš„ enum ä¾†é”æˆé€šç”¨çš„ç›®çš„ï¼Œä½†è€ƒæ…®åˆ°éœ€æ±‚æ˜¯ ignore çš„æ™‚å€™ï¼Œæˆ‘å¸Œæœ›ä½¿ç”¨ä¸Šå¯ä»¥æ›´å–®ç´”ä¸€é»ï¼Œä¸ç”¨å†æŒ‡å®š Providerã€‚ æ‰€ä»¥æœ€çµ‚é¸æ“‡æ‹†æˆå…©å€‹ã€‚</p><li><h4 id="æœ€å¾Œä¸€ç¨®æœ€éº»ç…©decodeuniversal"><span class="mr-2">æœ€å¾Œä¸€ç¨®æœ€éº»ç…©ï¼šDecodeUniversal</span><a href="#æœ€å¾Œä¸€ç¨®æœ€éº»ç…©decodeuniversal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>ç›´æ¥ä¸Š Code</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">LosslessAndDecodable</span> <span class="o">=</span> <span class="kt">LosslessStringConvertible</span> <span class="o">&amp;</span> <span class="kt">Decodable</span>
    
 <span class="kd">@propertyWrapper</span>
 <span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DecodeUniversal</span><span class="p">:</span> <span class="kt">Decodable</span> <span class="p">{</span>
    
     <span class="kd">public</span> <span class="k">var</span> <span class="nv">wrappedValue</span><span class="p">:</span> <span class="kt">Value</span>
    
     <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    
         <span class="k">let</span> <span class="nv">container</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">singleValueContainer</span><span class="p">()</span>
    
         <span class="k">do</span> <span class="p">{</span>
             <span class="n">wrappedValue</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Value</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    
             <span class="k">let</span> <span class="nv">temp</span><span class="p">:</span> <span class="kt">String</span>
             <span class="k">if</span> <span class="k">let</span> <span class="nv">strValue</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                 <span class="n">temp</span> <span class="o">=</span> <span class="n">strValue</span>
             <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">intValue</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                 <span class="n">temp</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">intValue</span><span class="se">)</span><span class="s">"</span>
             <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">doubleValue</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span>
                 <span class="n">temp</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">doubleValue</span><span class="se">)</span><span class="s">"</span>
             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                 <span class="k">throw</span> <span class="n">error</span>
             <span class="p">}</span>
    
             <span class="k">if</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="kt">Value</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="p">{</span>
                 <span class="n">wrappedValue</span> <span class="o">=</span> <span class="n">value</span>
             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                 <span class="k">throw</span> <span class="n">error</span>
             <span class="p">}</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></table></code></div></div><p>é€™é‚Šæœ‰ä¸€å€‹æ¯”è¼ƒå°‘çœ‹åˆ°çš„ <code class="language-plaintext highlighter-rouge">protocol LosslessStringConvertible</code>ï¼Œè©³ç´°çš„å®šç¾©å¯ä»¥åƒè€ƒ <a href="https://developer.apple.com/documentation/swift/losslessstringconvertible">Document</a>ï¼Œç°¡å–®ä¾†èªªå®ƒæä¾›äº†æˆ‘å€‘ç”¨å­—ä¸²å»ºç«‹ Int, Double ç­‰é¡å‹çš„èƒ½åŠ›ã€‚</p><p>æ‰€ä»¥æˆ‘å€‘å…ˆ <code class="language-plaintext highlighter-rouge">decode(Value.self)</code> ä¸€æ¬¡çœ‹çœ‹ï¼Œå¤±æ•—çš„è©±ï¼Œæˆ‘å€‘å¾ String -&gt; Int -&gt; Double ä¾æ¬¡ decodeï¼Œåªè¦ decode æˆåŠŸï¼Œå°±æŠŠå€¼è½‰æˆ String å­˜èµ·ä¾†ã€‚å¦‚æœä¾ç„¶ decode å¤±æ•—ï¼Œå‹‡æ•¢çš„ throw å‡ºå»å§ï¼</p><p>æ¥è‘—åˆ©ç”¨ <code class="language-plaintext highlighter-rouge">LosslessStringConvertible</code> æä¾›çš„ <code class="language-plaintext highlighter-rouge">init?(_ description: String)</code> ä¾†å˜—è©¦å»ºç«‹ç‰©ä»¶ï¼Œå¦‚æœé‚„æ˜¯å¤±æ•—ï¼Œå‹‡æ•¢çš„ throw å‡ºå»å§ï¼</p><p>åˆ°é€™é‚Šå°±å®Œæˆå•¦ ğŸ˜„</p></ol><h2 id="-è®“æˆ‘å€‘å›é ­çœ‹çœ‹"><span class="mr-2"># è®“æˆ‘å€‘å›é ­çœ‹çœ‹</span><a href="#-è®“æˆ‘å€‘å›é ­çœ‹çœ‹" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>âœ… 1. è§£æ±ºæ–¹æ³•æ²’æœ‰çµ±ä¸€çš„ä»‹é¢ã€‚</p><p>âœ… 2. æŸäº›æ–¹æ³•å¯¦ä½œä¸æ˜“ã€‚</p><p>âŒ 2. æŸäº›æ–¹æ³•å‡ºéŒ¯çš„æ™‚å€™å®šä½ä¸å®¹æ˜“ï¼Œå› ç‚ºæœ¬è³ªä¸Šæ˜¯ Bug ï¼Œæ˜¯éœ€è¦è¢«è§£æ±ºçš„ã€‚</p><p>âŒ 3. å¾Œç«¯çš„é‹ç‚ºæ¯›æ˜¯æˆ‘å€‘æ‰›ï¼Ÿç‚ºæ¯›æ˜¯æˆ‘å€‘è¦æ‰¾å‡ºå•é¡Œåœ¨å“ªï¼Œå†è«‹å¾Œç«¯æ”¹ï¼Ÿ</p><p>å¿™äº†è€åŠå¤©ï¼Œæˆ‘å€‘åªè§£æ±ºäº†ä¸€åŠçš„å•é¡Œï¼Ÿ</p><p>åˆ¥ç·Šå¼µï¼Œé‚„æœ‰å¾ŒçºŒã€‚</p><h2 id="-è®“éŒ¯èª¤å‡ºç¾æ™‚æœ‰ä¸€å€‹-handler"><span class="mr-2"># è®“éŒ¯èª¤å‡ºç¾æ™‚æœ‰ä¸€å€‹ Handler</span><a href="#-è®“éŒ¯èª¤å‡ºç¾æ™‚æœ‰ä¸€å€‹-handler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>æˆ‘å€‘å…ˆå®£å‘Šä¸€å€‹ <code class="language-plaintext highlighter-rouge">protocol DecodeErrorDelegate</code>ï¼Œä¸¦å®£å‘Š <code class="language-plaintext highlighter-rouge">DecodeStrategy</code> è£¡é¢æœ‰ä¸€å€‹ <code class="language-plaintext highlighter-rouge">static var</code> æ˜¯ <code class="language-plaintext highlighter-rouge">DecodeErrorDelegate</code>ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">DecodeErrorDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">onCatch</span><span class="p">(</span><span class="nv">error</span><span class="p">:</span> <span class="kt">Error</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DecodeStrategy</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">errorDelegate</span><span class="p">:</span> <span class="kt">DecodeErrorDelegate</span><span class="p">?</span>
<span class="p">}</span>

</pre></table></code></div></div><p>æ¥è‘—æˆ‘å€‘åœ¨ catch error çš„æ™‚å€™ï¼ŒæŠŠ error é€é <code class="language-plaintext highlighter-rouge">DecodeStrategy.errorDelegate?.onCatch(error:)</code> å‚³å‡ºå»ã€‚</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="å·²è¦†åˆ¶ï¼"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">do</span> <span class="p">{</span>
    <span class="n">wrappedValue</span> <span class="o">=</span> <span class="k">try</span> <span class="n">container</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Provider</span><span class="o">.</span><span class="kt">Value</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="kt">DecodeStrategy</span><span class="o">.</span><span class="n">errorDelegate</span><span class="p">?</span><span class="o">.</span><span class="nf">onCatch</span><span class="p">(</span><span class="nv">error</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span>
    <span class="n">wrappedValue</span> <span class="o">=</span> <span class="kt">Provider</span><span class="o">.</span><span class="n">defaultValue</span>
<span class="p">}</span>
</pre></table></code></div></div><p>å®Œç¾ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥åœ¨ä½¿ç”¨çš„æ™‚å€™æœ‰ä¸€å€‹çµ±ä¸€çš„æ¥å£å¯ä»¥åšäº‹äº†ã€‚ä½ å¯ä»¥åœ¨è‡ªå·±çš„ DecodeErrorDelegate è¨­ç½® flag ï¼Œæ¨™æ³¨ç¾åœ¨æº–å‚™ deocde å“ªå€‹ response modelï¼Œä¸¦åœ¨ onCatch çš„æ™‚å€™å°å‡ºä¾†ï¼Œæˆ–è€…è«‹å¾Œç«¯ç›´æ¥å†é–‹ä¸€éš»æ¥æ”¶ JSON Bug çš„ APIï¼Œæ¯æ¬¡ onCatch éƒ½å‘¼å« API é€šçŸ¥å¾Œç«¯ä¿®æ­£ã€‚æƒ³æ€éº¼ç©å°±æ€éº¼ç©ã€‚</p><p>å®Œæ•´çš„å°ˆæ¡ˆåœ¨ <a href="https://github.com/ohlulu/DecodeStrategy">Github</a>ã€‚å¦‚æœä½ è¦ºå¾—ä¸éŒ¯çš„è©±ï¼Œæ­¡è¿çµ¦å€‹ Star æ”¯æŒä¸€ä¸‹ ğŸ˜„</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tip/'>tip</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> æœ¬æ–‡ç”±ä½œè€…æŒ‰ç…§ <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> é€²è¡Œæˆæ¬Š</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">åˆ†äº«</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ç•¶ Decodable é‡ä¸Š @propertyWrapper - Ohlulu&amp;url=https://ohlulu.github.io/posts/decodable_propertywrapper/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ç•¶ Decodable é‡ä¸Š @propertyWrapper - Ohlulu&amp;u=https://ohlulu.github.io/posts/decodable_propertywrapper/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://ohlulu.github.io/posts/decodable_propertywrapper/&amp;text=ç•¶ Decodable é‡ä¸Š @propertyWrapper - Ohlulu" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="åˆ†äº«éˆæ¥" data-title-succeed="éˆæ¥å·²è¦†åˆ¶ï¼"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">æœ€è¿‘æ›´æ–°</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ohswifterframework/">å¿ƒè·¯æ­·ç¨‹-æ‰“é€ ä¸€å€‹å„ªé›…çš„åˆå§‹åŒ–æ¡†æ¶</a></ul></div><div id="access-tags"><div class="panel-heading">ç†±é–€æ¨™ç°½</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/animation/">animation</a> <a class="post-tag" href="/tags/tip/">tip</a> <a class="post-tag" href="/tags/transition/">transition</a> <a class="post-tag" href="/tags/alamofire/">alamofire</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/xcode/">xcode</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">æ–‡ç« å…§å®¹</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>ç›¸é—œæ–‡ç« </h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ohswifterframework/"><div class="card-body"> <em class="timeago small" data-ts="1565625600" > 2019-08-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>å¿ƒè·¯æ­·ç¨‹-æ‰“é€ ä¸€å€‹å„ªé›…çš„åˆå§‹åŒ–æ¡†æ¶</h3><div class="text-muted small"><p> æœ€è¿‘å› ç‚ºæ‰‹ä¸Šçš„æ¡ˆå­å‘Šä¸€æ®µè½ï¼Œè·é›¢ä¸‹ä¸€å€‹æ¡ˆå­é€²å…¥é–‹ç™¼éšæ®µä¹Ÿé‚„æœ‰ä¸€é»æ™‚é–“ï¼Œæ‰€ä»¥èˆˆèµ·äº†æ•´ç†è‡ªå·±å¸¸ç”¨çš„ extension çš„æƒ³æ³•ã€‚ ä»¥ç›®å‰å¾…åœ¨æ¥æ¡ˆå…¬å¸ä¾†èªªï¼Œé‡è¦çš„å°±æ˜¯ç•«é¢çš„å¿«é€Ÿç”¢å‡ºï¼Œé‚è¼¯çš„éƒ¨åˆ†ç›¸å°ç”¢å“ä¾†èªªï¼Œå…¶å¯¦æ²’æœ‰é‚£éº¼è¤‡é›œã€‚ æ‰€ä»¥åœ¨ç•«é¢ç˜‹ç‹‚çš„å»ºç«‹&amp;amp;è¨­ç½®çš„æƒ…æ³ä¸‹ï¼Œä¸€å€‹æ–¹ä¾¿å¥½ç”¨çš„è¨­ç½®æ–¹å¼ï¼Œå…¶å¯¦æ»¿é‡è¦çš„ã€‚åœ¨é‡è¤‡å»ºç«‹ç›¸ä¼¼ä½†å»ä¸ä¸€æ¨£çš„ UI æ™‚ï¼Œä¹Ÿæœƒç›¸å°çš„è¼•é¬†ï¼Œä¸”æ„‰æ‚…ã€‚ æ‰€ä»¥é€™ç¯‡æœƒç°¡è¿°ä¸€ä¸‹ï¼Œæˆ‘...</p></div></div></a></div><div class="card"> <a href="/posts/coderengin/"><div class="card-body"> <em class="timeago small" data-ts="1587225600" > 2020-04-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CoderEngin-æ¼‚äº®çš„æ–¹å¼å–ç”¨åœ–ç‰‡</h3><div class="text-muted small"><p> #èµ· åœ¨ iOS é–‹ç™¼çš„éç¨‹ä¸­ï¼Œå–ç”¨åœ–ç‰‡çš„æ™‚å€™æˆ‘å€‘ç¶“å¸¸ä½¿ç”¨ UIImage(named: &quot;add&quot;) é€™æ¨£çš„æ–¹å¼ï¼Œä½¿ç”¨åœ–ç‰‡æª”å+å­—ä¸²çš„æ–¹å¼ï¼Œé›–ç„¶ç¾åœ¨å¤šæ•¸çš„è¨­è¨ˆå¸«æœƒä½¿ç”¨ zeplin ç­‰å·¥å…·æ–¹ä¾¿å·¥ç¨‹å¸«è¤‡è£½æª”åï¼Œä½†ä½¿ç”¨å­—ä¸²ç¸½æ˜¯ä¸é‚£éº¼æ¼‚äº®ã€‚ è€Œä¸”æ¯æ¬¡ä½¿ç”¨éƒ½å€è¦å…ˆæŠŠè¦–çª—åˆ‡åˆ° zeplin åœ¨åˆ‡å›ä¾†ã€‚å€‹äººä½¿ç”¨èµ·ä¾†ç¸½æ„Ÿè¦ºä¸æ˜¯é‚£éº¼æµæš¢ã€‚ #æ‰¿ å› æ­¤ï¼Œåœ¨ä¹‹å¾Œçš„å°ˆæ¡ˆä¸­ï¼Œæƒ³åˆ°ä½¿ç”¨ UIImage st...</p></div></div></a></div><div class="card"> <a href="/posts/alamofire-apirouter/"><div class="card-body"> <em class="timeago small" data-ts="1568908800" > 2019-09-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Alamofire - APIRouter</h3><div class="text-muted small"><p> Alamofire - APIRouter 2020/6 æ›´æ–° åœ¨ iPlayground2019 è½å®Œç‹å·å¤§å¤§çš„ talk ä¹‹å¾Œï¼Œåˆè‡ªå·±å¯¦ä½œäº†ä¸‰æ¬¡ï¼Œå·²ç¶“æ”¾æ£„ä¸‹é¢çš„å°è£æ–¹å¼ ç¯„ä¾‹åœ¨ Githubï¼Œå› ç‚ºå¯¦ä½œæ¦‚å¿µåŸºæœ¬ä¸Šç­‰åŒç‹å·å¤§å¤§çš„ Talkï¼ˆå¤šäº†ä¸€äº›åƒè€ƒè‡ª Moya çš„æ¦‚å¿µï¼‰æ‰€ä»¥ç­‰ å“ªå¤©å¿ƒæƒ…å¥½ æœ‰ç©ºï¼Œå†ä¾†å¯«ä¸€ç¯‡æ–‡ç« å¥½äº†å“ˆå“ˆå“ˆå“ˆå“ˆã€‚ # èµ· Alamofire ç›¸ä¿¡é–‹ç™¼ iOS çš„äººéƒ½ä¸...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/coderengin/" class="btn btn-outline-primary" prompt="ä¸Šä¸€ç¯‡"><p>CoderEngin-æ¼‚äº®çš„æ–¹å¼å–ç”¨åœ–ç‰‡</p></a> <span class="btn btn-outline-primary disabled" prompt="ä¸‹ä¸€ç¯‡"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2022 <a href="https://twitter.com/username">ohlulu</a>. <span data-toggle="tooltip" data-placement="top" title="é™¤éå¦æœ‰èªªæ˜ï¼Œæœ¬ç¶²ç«™ä¸Šçš„åšå®¢æ–‡ç« å‡ç”±ä½œè€…æŒ‰ç…§çŸ¥è­˜å…±äº«ç½²å 4.0 åœ‹éš› (CC BY 4.0) è¨±å¯å”è­°é€²è¡Œæˆæ¬Šã€‚">ä¿ç•™éƒ¨åˆ†æ¬Šåˆ©ã€‚</span></p></div><div class="footer-right"><p class="mb-0"> æœ¬ç«™ç”± <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> ç”Ÿæˆï¼Œé‡‡ç”¨ <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> ä¸»é¡Œã€‚</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">ç†±é–€æ¨™ç°½</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/animation/">animation</a> <a class="post-tag" href="/tags/tip/">tip</a> <a class="post-tag" href="/tags/transition/">transition</a> <a class="post-tag" href="/tags/alamofire/">alamofire</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/xcode/">xcode</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">æœç´¢çµæœç‚ºç©º</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
